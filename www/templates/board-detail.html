<ion-view view-title="{{title}}" style="background-color:#E8E8E8;" cache-view="false">
  <ion-content has-header="true" overflow-scroll="true">

    <!-- 오픈스펙에선 빠짐
    <div class="bar bar-header item-input-inset">
    <label class="item-input-wrapper">
    <i class="icon ion-ios-search placeholder-icon"></i>
    <input type="search" placeholder="Search">
    </label>
    <button class="button button-clear">
    검색
    </button>
    </div>
    -->
   
	<div class="col text-right">
	  <button class="button button-small button-light" ng-click="post_comment()">글작성</button>
	</div>

	<ion-list>

	  <ion-item ng-repeat="c in comment_container" style="border-width: 1px; padding:0px; margin-bottom: 20px; margin-left:10px; margin-right:10px">

	    <div class="card" style="margin:0px; padding:0px;">
	      <div class="c item-divider">
		<span style="font-size:80%; margin-top:10px;">
		  

		  <p style="font-size:90%;"> <b>&nbsp {{c.subject}} </b> </p>

		</span>
	      </div>

	      <div ng-if="c.is_open!=true">
		<div style="text-align:center;">
		  <button class="button button-clear button-calm" ng-click="open_comment($index)">
		    <span style="font-size: 90%;">
		      게시글 보기
		    </span>
		  </button>
		</div>

	      </div>

	      <div ng-if="c.is_open==true">
		<div class="item item-text-wrap">
		  <span style="font-size: 75%; margin-top:10px; color:gray;">
		    <!-- 작성자: {{c.name}} &nbsp&nbsp 작성: {{c.date}} &nbsp&nbsp 조회: {{c.view}} -->
		    작성자: {{c.name}} &nbsp&nbsp <span am-time-ago="c.date"></span> &nbsp&nbsp 조회수: {{c.view}}
		  </span>

		  <!--
		  <p style="font-size: 85%; margin-top:10px;">
		    <span dynamic="c.comment"></span>		      
		    {{c.comment}}
		  </p>
		  -->
		  <p style="margin-top:10px;">
		    <span style="font-size: 85%; color:black;" dynamic="c.comment"></span>
		  </p>

		  
		  <button class="button button-clear button-positive" style="float:right;" ng-click="post_reply($index)">
		    <span style="font-size: 80%; margin-top:10px;">
		      댓글작성
		    </span>
		  </button>


		  <div ng-if="c.fid == user_info.fb.id">
		    <button class="button button-clear button-positive" style="float:right;" ng-click="post_remove($index)">
		      <span style="font-size: 80%; margin-top:10px;">
			삭제
		      </span>
		    </button>

		    <button class="button button-clear button-positive" style="float:right;" ng-click="post_modify($index)">
		      <span style="font-size: 80%; margin-top:10px;">
			수정
		      </span>
		    </button>
		  </div>
		</div>
	      </div>

	    </div>

	    <div ng-if="c.is_open==true">
	    <div ng-if="c.is_open_reply!=true">
	      <button class="button button-full button-light" style="margin:0px;line-height:32px;min-height:32px;" ng-click="open_replys($index)">

		<div ng-if="c.replys.length > 0">
		  <span style="font-size: 90%;"> {{c.replys.length}}개의 댓글 </span>
		  <i class="ion-chevron-down"></i>
		</div>
		<div ng-if="c.replys.length == 0">
		  <span style="font-size: 90%;">  댓글 없음 </span>
		</div>

		<!--
		<div ng-repeat="r in c.replys">
		  {{r}}
		  
		</div>
		-->
	      </button>
	    </div>

	    <div ng-if="c.is_open_reply==true">
	      <div class="row">
		<div class="col">

		  <button class="button button-full button-light" style="margin:0px;line-height:29px;min-height:29px; margin-bottom:10px;" ng-click="close_replys($index)">
		    <span style="font-size: 90%;">댓글 닫기 </span>
		    <i class="ion-chevron-up"></i>
		  </button>
		  

		  <div ng-repeat="r in c.replys">

		    <span style="font-size: 75%; margin-top:10px;">
		      글쓴이: {{r.name}} &nbsp&nbsp 날짜: <span am-time-ago="r.date"></span>&nbsp&nbsp
		    </span>
		    
		    <!--
		    <p style="font-size:85%;margin-top:10px;margin-bottom:10px;white-space:normal;overflow:visible;">
		      {{r.reply}}
		    </p>
		    -->
		    <p style="margin-top:10px;margin-bottom:10px;white-space:normal;overflow:visible;">
		      <span style="font-size: 85%;" dynamic="r.reply"></span>
		    </p>


		    <div ng-if="r.fid == user_info.fb.id">
		      <div class="col text-right" style="padding:0px; margin:0px">
			<button class="button button-clear button-positive" style="margin:0px; min-height: 20px;" ng-click="reply_modify(c._id, r._id, r.reply)"> <span style="font-size: 80%; margin-top:10px;">
			  수정
			</span></button>
			<button class="button button-clear button-positive" style="margin:0px; min-height: 20px;" ng-click="reply_remove(c._id, r._id)"> <span style="font-size: 80%; margin-top:10px;">
			  삭제
			</span></button>
		      </div>
		    </div>

		    <div ng-if="item.reply_container.length-1 != $index">
		      <hr style="margin-top:0px">
		    </div>

		  </div>


		</div>
	      </div>
	    </div>
	    </div>

	  </ion-item>
	  
	  
	  
	</ion-list>

	<div ng-if="is_next==true" style="margin-bottom: 20px; margin-left:10px; margin-right:10px;">
	  <button class="button button-block button-stable" ng-click="c_more()">
	    더보기
	  </button>
	</div>

     
    <br>
    <br>
    <br>
  </ion-content>
</ion-view>
